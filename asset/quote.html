<style>
    a.postidlink + div {
   margin: 0.5em 0.2em 0.5em 1em;
   padding: 1em 0.9em;
   background-color: var(--nc-bg-2);
   color: var(--nc-tx-2);
   font-size: 0.8em;
   list-style: 1.2;
   border-radius: 5px;
   border-width: 2px;
   border-style: solid;
   border-color: var(--nc-bg-3);
}
</style>
<script>

    $(document).ready(function () {
        // 記事リンクに標準で付加されているpostidlinkをトリガーにする
        $('.postidlink').each(function (index) {
            var linkElement = $(this);
            // そのあとに<div class="qpost-番号">を加える。
            // qpost=QuotePostです。クラス部分はお好みで変更可
            var newDivElement = $('<div>').addClass('qpost-' + (index + 1));

            // リンク要素の後に新しい div 要素を挿入
            linkElement.after(newDivElement);

            var linkURL = linkElement.attr('href');

            $.ajax({
                url: linkURL,
                type: 'GET',
                dataType: 'html',
                success: function (html) {
                    var tempDiv = $('<div>').html(html);

                    // リンク先から取得した内容から<div class="comment">のテキストを抽出
                    // comment以外のクラス指定の場合はfind('.comment')の部分を書き換え
                    // プレーンテキストで表示する場合は.html()を.text()に書き換え
                    var commentContent = tempDiv.find('.comment').html();

                    // 加える文字列を制限して350文字までに切り詰め
                    var maxLength = 350;
                    var limitedContent = commentContent.length > maxLength ?
                        // 省略する場合は省略記号...を追加
                        commentContent.substring(0, maxLength) + '...' :
                        commentContent;

                    // 新しい div 要素にリンク先の内容を追加
                    // プレーンテキストで表示する場合は.html(略)を.text(略)に書き換え
                    newDivElement.html(limitedContent);
                },
                error: function (error) {
                    console.error('エラー:', error);
                }
            });
        });
    });
</script>
